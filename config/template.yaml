# =========================
# 1. åŸºç¡€ç¯å¢ƒè®¾ç½® (æœåŠ¡å™¨å®‰å…¨é»˜è®¤)
# =========================
mixed-port: 7890
socks-port: 7891
tproxy-port: 7893

allow-lan: false
bind-address: "127.0.0.1"

ipv6: false
log-level: info
mode: rule

# é¢æ¿ï¼šæœåŠ¡å™¨å»ºè®®ä»…æœ¬æœºï¼Œè¿œç¨‹ç”¨ SSH éš§é“
external-controller: 127.0.0.1:9090
external-ui: "ui"
secret: "CHANGE_ME_TO_A_STRONG_SECRET"

profile:
  store-selected: true

# =========================
# 2. DNS è®¾ç½®ï¼ˆæœåŠ¡å™¨é»˜è®¤ä»…æœ¬æœºï¼‰
# =========================
dns:
  enable: true
  listen: 127.0.0.1:1053
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  default-nameserver:
    - 223.5.5.5
    - 119.29.29.29
  nameserver:
    - https://dns.google/dns-query
    - https://1.1.1.1/dns-query
  direct-nameserver:
    - 223.5.5.5
    - 119.29.29.29

# =========================
# 3. èŠ‚ç‚¹è®¢é˜…ï¼ˆproxy-providersï¼‰
# =========================
proxy-providers:
  UserSub:
    type: http
    url: "INSERT_LINK_HERE" # [SUBLINK]
    path: ./sub/usersub.yaml
    interval: 3600
    health-check:
      enable: true
      interval: 600
      url: http://www.gstatic.com/generate_204

# =========================
# 4. è§„åˆ™é›†ï¼ˆRULE-SET ä¾èµ–ï¼‰
# =========================
rule-providers:
  ADBlock:
    type: http
    behavior: domain
    format: mrs
    interval: 86400
    url: https://adrules.top/adrules-mihomo.mrs
    path: ./ruleset/ADBlock.mrs

  AdditionalFilter:
    type: http
    behavior: classical
    format: text
    interval: 86400
    url: https://gcore.jsdelivr.net/gh/powerfullz/override-rules@master/ruleset/AdditionalFilter.list
    path: ./ruleset/AdditionalFilter.list

  SogouInput:
    type: http
    behavior: classical
    format: text
    interval: 86400
    url: https://ruleset.skk.moe/Clash/non_ip/sogouinput.txt
    path: ./ruleset/SogouInput.txt

  StaticResources:
    type: http
    behavior: domain
    format: text
    interval: 86400
    url: https://ruleset.skk.moe/Clash/domainset/cdn.txt
    path: ./ruleset/StaticResources.txt

  CDNResources:
    type: http
    behavior: classical
    format: text
    interval: 86400
    url: https://ruleset.skk.moe/Clash/non_ip/cdn.txt
    path: ./ruleset/CDNResources.txt

  AdditionalCDNResources:
    type: http
    behavior: classical
    format: text
    interval: 86400
    url: https://gcore.jsdelivr.net/gh/powerfullz/override-rules@master/ruleset/AdditionalCDNResources.list
    path: ./ruleset/AdditionalCDNResources.list

  EHentai:
    type: http
    behavior: classical
    format: text
    interval: 86400
    url: https://gcore.jsdelivr.net/gh/powerfullz/override-rules@master/ruleset/EHentai.list
    path: ./ruleset/EHentai.list

  TikTok:
    type: http
    behavior: classical
    format: text
    interval: 86400
    url: https://gcore.jsdelivr.net/gh/powerfullz/override-rules@master/ruleset/TikTok.list
    path: ./ruleset/TikTok.list

  SteamFix:
    type: http
    behavior: classical
    format: text
    interval: 86400
    url: https://gcore.jsdelivr.net/gh/powerfullz/override-rules@master/ruleset/SteamFix.list
    path: ./ruleset/SteamFix.list

  GoogleFCM:
    type: http
    behavior: classical
    format: text
    interval: 86400
    url: https://gcore.jsdelivr.net/gh/powerfullz/override-rules@master/ruleset/FirebaseCloudMessaging.list
    path: ./ruleset/GoogleFCM.list

  # CNï¼šç”¨äºâ€œå›½å†…ä¹Ÿèµ°ä»£ç†ï¼ˆğŸ‡¨ğŸ‡³å‡ºå£ï¼‰â€
  cn_domain:
    type: http
    behavior: domain
    format: mrs
    interval: 86400
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/cn.mrs"
    path: ./ruleset/cn_domain.mrs

  cn_ip:
    type: http
    behavior: ipcidr
    format: mrs
    interval: 86400
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/cn.mrs"
    path: ./ruleset/cn_ip.mrs

  geolocation-!cn:
    type: http
    behavior: domain
    format: mrs
    interval: 86400
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/geolocation-!cn.mrs"
    path: ./ruleset/geolocation-!cn.mrs

# =========================
# 5. ç­–ç•¥ç»„ï¼ˆæ¯ç»„éƒ½å¯ç›´æ¥é€‰å…·ä½“èŠ‚ç‚¹ï¼‰
# =========================
proxy-groups:
  - name: ğŸš€ èŠ‚ç‚¹é€‰æ‹©
    type: select
    proxies:
      - DIRECT
    use:
      - UserSub

  - name: âš¡ è‡ªåŠ¨ä¼˜é€‰
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 50
    use:
      - UserSub

  # åªè¦ ğŸ‡¨ğŸ‡³ çš„å›½å†…è‡ªåŠ¨ä¼˜é€‰/å‡ºå£ï¼ˆå¹¶å…è®¸æ‰‹åŠ¨åˆ‡ DIRECTï¼‰
  - name: ğŸ‡¨ğŸ‡³ å›½å†…è‡ªåŠ¨ä¼˜é€‰
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 50
    use:
      - UserSub
    filter: "ğŸ‡¨ğŸ‡³"

  - name: ğŸ‡¨ğŸ‡³ å›½å†…å‡ºå£
    type: select
    proxies:
      - ğŸ‡¨ğŸ‡³ å›½å†…è‡ªåŠ¨ä¼˜é€‰
      - DIRECT
      - ğŸš€ èŠ‚ç‚¹é€‰æ‹©
      - âš¡ è‡ªåŠ¨ä¼˜é€‰
    use:
      - UserSub
    filter: "ğŸ‡¨ğŸ‡³"

  - name: ğŸ‡¨ğŸ‡³ å›½å†…å‡ºå£-æ¨¡å¼
    type: select
    proxies:
      - ğŸ‡¨ğŸ‡³ å›½å†…å‡ºå£
      - DIRECT
      - ğŸš€ èŠ‚ç‚¹é€‰æ‹©
      - âš¡ è‡ªåŠ¨ä¼˜é€‰

  # ä¸šåŠ¡ç»„ï¼šéƒ½èƒ½ç›´æ¥é€‰ä»»æ„èŠ‚ç‚¹ï¼ˆuse: UserSubï¼‰
  - name: ğŸ“¹ YouTube
    type: select
    proxies: [DIRECT, âš¡ è‡ªåŠ¨ä¼˜é€‰, ğŸš€ èŠ‚ç‚¹é€‰æ‹©, ğŸ‡¨ğŸ‡³ å›½å†…å‡ºå£]
    use: [UserSub]

  - name: ğŸµ Spotify
    type: select
    proxies: [DIRECT, âš¡ è‡ªåŠ¨ä¼˜é€‰, ğŸš€ èŠ‚ç‚¹é€‰æ‹©, ğŸ‡¨ğŸ‡³ å›½å†…å‡ºå£]
    use: [UserSub]

  - name: ğŸ’³ PayPal
    type: select
    proxies: [DIRECT, ğŸš€ èŠ‚ç‚¹é€‰æ‹©, âš¡ è‡ªåŠ¨ä¼˜é€‰]
    use: [UserSub]

  - name: ğŸ¤– AI & Copilot
    type: select
    proxies: [DIRECT, âš¡ è‡ªåŠ¨ä¼˜é€‰, ğŸš€ èŠ‚ç‚¹é€‰æ‹©]
    use: [UserSub]

  - name: ğŸ“º å…¶ä»–æµåª’ä½“
    type: select
    proxies: [DIRECT, âš¡ è‡ªåŠ¨ä¼˜é€‰, ğŸš€ èŠ‚ç‚¹é€‰æ‹©]
    use: [UserSub]

  - name: ğŸ’° è™šæ‹Ÿè´§å¸
    type: select
    proxies: [DIRECT, ğŸš€ èŠ‚ç‚¹é€‰æ‹©, âš¡ è‡ªåŠ¨ä¼˜é€‰]
    use: [UserSub]

  - name: ğŸ“² ç”µæŠ¥æ¶ˆæ¯
    type: select
    proxies: [DIRECT, âš¡ è‡ªåŠ¨ä¼˜é€‰, ğŸš€ èŠ‚ç‚¹é€‰æ‹©]
    use: [UserSub]

  - name: ğŸ¦ Twitter(X)
    type: select
    proxies: [DIRECT, âš¡ è‡ªåŠ¨ä¼˜é€‰, ğŸš€ èŠ‚ç‚¹é€‰æ‹©]
    use: [UserSub]

  - name: ğŸ Apple
    type: select
    proxies: [DIRECT, ğŸ‡¨ğŸ‡³ å›½å†…å‡ºå£, ğŸš€ èŠ‚ç‚¹é€‰æ‹©, âš¡ è‡ªåŠ¨ä¼˜é€‰]
    use: [UserSub]

  - name: ğŸ“¦ PikPak
    type: select
    proxies: [DIRECT, âš¡ è‡ªåŠ¨ä¼˜é€‰, ğŸš€ èŠ‚ç‚¹é€‰æ‹©]
    use: [UserSub]

  - name: ğŸš„ Speedtest
    type: select
    proxies: [DIRECT, ğŸ‡¨ğŸ‡³ å›½å†…å‡ºå£, ğŸš€ èŠ‚ç‚¹é€‰æ‹©, âš¡ è‡ªåŠ¨ä¼˜é€‰]
    use: [UserSub]

  - name: ğŸ§‘â€ğŸ’» å¼€å‘è€…èµ„æº
    type: select
    proxies: [DIRECT, âš¡ è‡ªåŠ¨ä¼˜é€‰, ğŸš€ èŠ‚ç‚¹é€‰æ‹©]
    use: [UserSub]

  - name: ğŸ“š å­¦æœ¯èµ„æº
    type: select
    proxies: [DIRECT, âš¡ è‡ªåŠ¨ä¼˜é€‰, ğŸš€ èŠ‚ç‚¹é€‰æ‹©]
    use: [UserSub]

  - name: ğŸ® æ¸¸æˆå¹³å°
    type: select
    proxies: [DIRECT, âš¡ è‡ªåŠ¨ä¼˜é€‰, ğŸš€ èŠ‚ç‚¹é€‰æ‹©, ğŸ‡¨ğŸ‡³ å›½å†…å‡ºå£]
    use: [UserSub]

  - name: ğŸ´ å·´å“ˆå§†ç‰¹
    type: select
    proxies: [DIRECT, âš¡ è‡ªåŠ¨ä¼˜é€‰, ğŸš€ èŠ‚ç‚¹é€‰æ‹©]
    use: [UserSub]

  - name: ğŸ“º å“”å“©å“”å“©
    type: select
    proxies: [DIRECT, ğŸ‡¨ğŸ‡³ å›½å†…å‡ºå£, ğŸš€ èŠ‚ç‚¹é€‰æ‹©]
    use: [UserSub]

  # è§„åˆ™é›†åˆ†ç»„
  - name: å¹¿å‘Šæ‹¦æˆª
    type: select
    proxies: [REJECT, DIRECT]

  - name: æœç‹—è¾“å…¥
    type: select
    proxies: [DIRECT, REJECT]

  - name: Truth Social
    type: select
    proxies: [DIRECT, âš¡ è‡ªåŠ¨ä¼˜é€‰, ğŸš€ èŠ‚ç‚¹é€‰æ‹©]
    use: [UserSub]

  - name: é™æ€èµ„æº
    type: select
    proxies: [DIRECT, ğŸš€ èŠ‚ç‚¹é€‰æ‹©, âš¡ è‡ªåŠ¨ä¼˜é€‰]
    use: [UserSub]

  - name: E-Hentai
    type: select
    proxies: [DIRECT, âš¡ è‡ªåŠ¨ä¼˜é€‰, ğŸš€ èŠ‚ç‚¹é€‰æ‹©]
    use: [UserSub]

  - name: TikTok
    type: select
    proxies: [DIRECT, âš¡ è‡ªåŠ¨ä¼˜é€‰, ğŸš€ èŠ‚ç‚¹é€‰æ‹©]
    use: [UserSub]

  - name: Steamä¿®å¤
    type: select
    proxies: [DIRECT, ğŸš€ èŠ‚ç‚¹é€‰æ‹©, âš¡ è‡ªåŠ¨ä¼˜é€‰]
    use: [UserSub]

  - name: Playå•†åº—ä¿®å¤
    type: select
    proxies: [DIRECT, âš¡ è‡ªåŠ¨ä¼˜é€‰, ğŸš€ èŠ‚ç‚¹é€‰æ‹©]
    use: [UserSub]

  - name: FCMæ¨é€
    type: select
    proxies: [DIRECT, ğŸš€ èŠ‚ç‚¹é€‰æ‹©, âš¡ è‡ªåŠ¨ä¼˜é€‰]
    use: [UserSub]

  - name: æ–°æµªå¾®åš
    type: select
    proxies: [DIRECT, ğŸ‡¨ğŸ‡³ å›½å†…å‡ºå£, ğŸš€ èŠ‚ç‚¹é€‰æ‹©]
    use: [UserSub]

  - name: ğŸŸ æ¼ç½‘ä¹‹é±¼
    type: select
    proxies: [ğŸš€ èŠ‚ç‚¹é€‰æ‹©, âš¡ è‡ªåŠ¨ä¼˜é€‰, ğŸ‡¨ğŸ‡³ å›½å†…å‡ºå£-æ¨¡å¼, DIRECT]
    use: [UserSub]

# =========================
# 6. åˆ†æµè§„åˆ™ï¼ˆå›½å†…ä¸ç›´è¿ï¼šèµ° ğŸ‡¨ğŸ‡³ å›½å†…å‡ºå£-æ¨¡å¼ï¼‰
# =========================
rules:
  - DST-PORT,22,DIRECT
  - DST-PORT,9090,DIRECT
  - DST-PORT,7890,DIRECT
  - DST-PORT,7891,DIRECT
  - DST-PORT,7893,DIRECT

  # ç§ç½‘æ°¸è¿œç›´è¿ï¼ˆæœåŠ¡å™¨/ç½‘å…³éƒ½å¿…é¡»ç•™ï¼‰
  - GEOIP,private,DIRECT

  # å¹¿å‘Š/è¿‡æ»¤
  - RULE-SET,ADBlock,å¹¿å‘Šæ‹¦æˆª
  - RULE-SET,AdditionalFilter,å¹¿å‘Šæ‹¦æˆª
  - RULE-SET,SogouInput,æœç‹—è¾“å…¥

  # é™æ€/CDN
  - RULE-SET,StaticResources,é™æ€èµ„æº
  - RULE-SET,CDNResources,é™æ€èµ„æº
  - RULE-SET,AdditionalCDNResources,é™æ€èµ„æº

  # Truth Social
  - DOMAIN-SUFFIX,truthsocial.com,Truth Social

  # ä¸“é¡¹/ä¿®å¤
  - RULE-SET,EHentai,E-Hentai
  - RULE-SET,TikTok,TikTok
  - RULE-SET,SteamFix,Steamä¿®å¤
  - RULE-SET,GoogleFCM,FCMæ¨é€
  - DOMAIN,services.googleapis.cn,Playå•†åº—ä¿®å¤

  # ä½ åŸæœ¬çš„ç«™ç‚¹åˆ†æµï¼ˆæ‰©å±•äº†ä¸€äº›ï¼Œä½†ä¸é‡å¤ï¼‰
  - GEOSITE,weibo,æ–°æµªå¾®åš
  - GEOSITE,paypal,ğŸ’³ PayPal
  - GEOSITE,apple,ğŸ Apple
  - GEOSITE,twitter,ğŸ¦ Twitter(X)

  - GEOSITE,telegram,ğŸ“² ç”µæŠ¥æ¶ˆæ¯
  - GEOIP,telegram,ğŸ“² ç”µæŠ¥æ¶ˆæ¯

  - GEOSITE,youtube,ğŸ“¹ YouTube
  - GEOSITE,spotify,ğŸµ Spotify
  - GEOSITE,netflix,ğŸ“º å…¶ä»–æµåª’ä½“
  - GEOSITE,disney,ğŸ“º å…¶ä»–æµåª’ä½“
  - GEOSITE,hbo,ğŸ“º å…¶ä»–æµåª’ä½“
  - GEOSITE,category-porn,ğŸ“º å…¶ä»–æµåª’ä½“

  - GEOSITE,pikpak,ğŸ“¦ PikPak
  - GEOSITE,ookla-speedtest,ğŸš„ Speedtest
  - GEOSITE,bahamut,ğŸ´ å·´å“ˆå§†ç‰¹
  - GEOSITE,bilibili,ğŸ“º å“”å“©å“”å“©

  - GEOSITE,category-dev,ğŸ§‘â€ğŸ’» å¼€å‘è€…èµ„æº
  - GEOSITE,category-scholar-!cn,ğŸ“š å­¦æœ¯èµ„æº
  - GEOSITE,category-games,ğŸ® æ¸¸æˆå¹³å°
  - GEOSITE,category-cryptocurrency,ğŸ’° è™šæ‹Ÿè´§å¸
  - GEOSITE,microsoft,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  - GEOSITE,google,ğŸš€ èŠ‚ç‚¹é€‰æ‹©

  # å›½å†…ï¼šä¸ç›´è¿ï¼Œå…¨éƒ¨èµ°â€œå›½å†…å‡ºå£-æ¨¡å¼â€ï¼ˆä½ å¯åœ¨é¢æ¿åˆ‡ DIRECTï¼‰
  - RULE-SET,cn_domain,ğŸ‡¨ğŸ‡³ å›½å†…å‡ºå£-æ¨¡å¼
  - RULE-SET,cn_ip,ğŸ‡¨ğŸ‡³ å›½å†…å‡ºå£-æ¨¡å¼

  # å…œåº•
  - RULE-SET,geolocation-!cn,ğŸŸ æ¼ç½‘ä¹‹é±¼
  - MATCH,ğŸŸ æ¼ç½‘ä¹‹é±¼
